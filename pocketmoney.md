powershellで、csvに保存する小遣い帳
日付入力は入力を、別ファイルのconvert-todate.ps1のfunction Convert-ToDate([string]$InputDate)を使用して日付に変換する
・csv形式は、日付,日付毎の連番,金額,項目 とする。ファイル名は"kodukai.csv"とし、スクリプトと同じフォルダに保存
・入力は1回で、日付(yyyy/mm/dd)、金額 (日付毎の連番は入力後自動採番)[日付.金額]。入力内容を解釈した日付と金額を表示する。次に項目の一覧を連番付きで表示し、項目を番号指定[<解釈された日付>.<入力された金額>:項目]、このとき入力なしの場合は、。項目が手入力の場合のみ次に項目入力[項目手入力] ([]内はプロンプト
・入力はテンキー対応のため、区切り文字は" "と","と"."とする
・dまたは-<区切り文字><日付-連番>と入力されたら、削除確認(1:yes 0:cancel)、該当データ削除、連番振りなおし
・dまたは-と入力されたら、直前の日付と連番より該当データ削除、削除確認(1:yes 0:cancel)、連番振りなおし
・uまたは.<区切り文字><日付-連番>と入力されたら、"[日付.連番]"というプロンプト表示、金額入力受付、連番再計算し該当データ更新
・uまたは.と入力されたら、直前の日付と連番より"[日付.連番]"というプロンプト表示、金額入力受付、連番再計算し該当データ更新
・lまたは*と入力されたら、一覧を日付と連番の昇順表示
・rまたは= と入力されたら、残高表示 (配列に保存し本命令実行時計算)
・sまたは0と入力されたら、月毎の合計を表示
・wまたは+ と入力されたら,追記保存
・q と入力されたら、保存確認後終了 (ただしwの直後は確認なし)
・h または? と入力されたら、ヘルプ表示

# 項目
食費
カフェ
外食
日用雑貨
交通
交際費
娯楽
美容・衣服
医療・保険
水道・光熱・通信
住まい
教育・教養
その他
手入力









以下をpowershell関数で実装して
#  日付入力の最小化ルール
関数エントリは次のようにする
function Convert-ToDate {
    param([string]$InputDate)
入力
* string または int の日付入力（例: 7, 25, 45, 105, 1225, 240105, 20240105）
* 省略部分は「当年・当月」で補完
出力
* [datetime] 型の日付
解釈ルール
1桁 or 2桁 → 日付（例: 7 → 当月7日）
存在しない日付なら「MDD」または「MD」と再解釈 (45 → 4月5日)(91 → 9月1日)
3桁 → MDD（例: 105 → 1月5日）
4桁 → MMDD（例: 1225 → 12月25日）
6桁 → YYMMDD（例: 240105 → 2024年1月5日）
8桁 → YYYYMMDD（例: 20240105 → 2024年1月5日）
実在しない日（2/30など）はエラー。

mattnのchoを利用します
vdの入力で削除対象をchoで選択後、削除
vuの入力で削除対象をchoで選択後、更新入力
